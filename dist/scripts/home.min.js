var module,countdown=function(a){function b(a,b){var c=a.getTime();return a.setMonth(a.getMonth()+b),Math.round((a.getTime()-c)/864e5)}function c(a){var b=a.getTime(),c=new Date(b);return c.setMonth(a.getMonth()+1),Math.round((c.getTime()-b)/864e5)}function d(a,b){if(b=b instanceof Date||null!==b&&isFinite(b)?new Date(+b):new Date,!a)return b;var c=+a.value||0;return c?(b.setTime(b.getTime()+c),b):((c=+a.milliseconds||0)&&b.setMilliseconds(b.getMilliseconds()+c),(c=+a.seconds||0)&&b.setSeconds(b.getSeconds()+c),(c=+a.minutes||0)&&b.setMinutes(b.getMinutes()+c),(c=+a.hours||0)&&b.setHours(b.getHours()+c),(c=+a.weeks||0)&&(c*=7),(c+=+a.days||0)&&b.setDate(b.getDate()+c),(c=+a.months||0)&&b.setMonth(b.getMonth()+c),(c=+a.millennia||0)&&(c*=10),(c+=+a.centuries||0)&&(c*=10),(c+=+a.decades||0)&&(c*=10),(c+=+a.years||0)&&b.setFullYear(b.getFullYear()+c),b)}function e(a,b){return o(a)+(1===a?j[b]:k[b])}function f(){}function g(a,b,d,e,f,g){if(0<=a[d]&&(b+=a[d],delete a[d]),b/=f,1>=b+1)return 0;if(0<=a[e]){switch(a[e]=+(a[e]+b).toFixed(g),e){case"seconds":if(60!==a.seconds||isNaN(a.minutes))break;a.minutes++,a.seconds=0;case"minutes":if(60!==a.minutes||isNaN(a.hours))break;a.hours++,a.minutes=0;case"hours":if(24!==a.hours||isNaN(a.days))break;a.days++,a.hours=0;case"days":if(7!==a.days||isNaN(a.weeks))break;a.weeks++,a.days=0;case"weeks":if(a.weeks!==c(a.refMonth)/7||isNaN(a.months))break;a.months++,a.weeks=0;case"months":if(12!==a.months||isNaN(a.years))break;a.years++,a.months=0;case"years":if(10!==a.years||isNaN(a.decades))break;a.decades++,a.years=0;case"decades":if(10!==a.decades||isNaN(a.centuries))break;a.centuries++,a.decades=0;case"centuries":if(10!==a.centuries||isNaN(a.millennia))break;a.millennia++,a.centuries=0}return 0}return b}function h(a,d,e,f,h,i){var j=new Date;a.start=d=d||j,a.end=e=e||j,a.units=f,a.value=e.getTime()-d.getTime(),0>a.value&&(j=e,e=d,d=j),a.refMonth=new Date(d.getFullYear(),d.getMonth(),15,12,0,0);try{a.millennia=0,a.centuries=0,a.decades=0,a.years=e.getFullYear()-d.getFullYear(),a.months=e.getMonth()-d.getMonth(),a.weeks=0,a.days=e.getDate()-d.getDate(),a.hours=e.getHours()-d.getHours(),a.minutes=e.getMinutes()-d.getMinutes(),a.seconds=e.getSeconds()-d.getSeconds(),a.milliseconds=e.getMilliseconds()-d.getMilliseconds();var k;for(0>a.milliseconds?(k=q(-a.milliseconds/1e3),a.seconds-=k,a.milliseconds+=1e3*k):1e3<=a.milliseconds&&(a.seconds+=r(a.milliseconds/1e3),a.milliseconds%=1e3),0>a.seconds?(k=q(-a.seconds/60),a.minutes-=k,a.seconds+=60*k):60<=a.seconds&&(a.minutes+=r(a.seconds/60),a.seconds%=60),0>a.minutes?(k=q(-a.minutes/60),a.hours-=k,a.minutes+=60*k):60<=a.minutes&&(a.hours+=r(a.minutes/60),a.minutes%=60),0>a.hours?(k=q(-a.hours/24),a.days-=k,a.hours+=24*k):24<=a.hours&&(a.days+=r(a.hours/24),a.hours%=24);0>a.days;)a.months--,a.days+=b(a.refMonth,1);if(7<=a.days&&(a.weeks+=r(a.days/7),a.days%=7),0>a.months?(k=q(-a.months/12),a.years-=k,a.months+=12*k):12<=a.months&&(a.years+=r(a.months/12),a.months%=12),10<=a.years&&(a.decades+=r(a.years/10),a.years%=10,10<=a.decades&&(a.centuries+=r(a.decades/10),a.decades%=10,10<=a.centuries&&(a.millennia+=r(a.centuries/10),a.centuries%=10))),d=0,!(1024&f)||d>=h?(a.centuries+=10*a.millennia,delete a.millennia):a.millennia&&d++,!(512&f)||d>=h?(a.decades+=10*a.centuries,delete a.centuries):a.centuries&&d++,!(256&f)||d>=h?(a.years+=10*a.decades,delete a.decades):a.decades&&d++,!(128&f)||d>=h?(a.months+=12*a.years,delete a.years):a.years&&d++,!(64&f)||d>=h?(a.months&&(a.days+=b(a.refMonth,a.months)),delete a.months,7<=a.days&&(a.weeks+=r(a.days/7),a.days%=7)):a.months&&d++,!(32&f)||d>=h?(a.days+=7*a.weeks,delete a.weeks):a.weeks&&d++,!(16&f)||d>=h?(a.hours+=24*a.days,delete a.days):a.days&&d++,!(8&f)||d>=h?(a.minutes+=60*a.hours,delete a.hours):a.hours&&d++,!(4&f)||d>=h?(a.seconds+=60*a.minutes,delete a.minutes):a.minutes&&d++,!(2&f)||d>=h?(a.milliseconds+=1e3*a.seconds,delete a.seconds):a.seconds&&d++,!(1&f)||d>=h){var l=g(a,0,"milliseconds","seconds",1e3,i);if(l&&(l=g(a,l,"seconds","minutes",60,i))&&(l=g(a,l,"minutes","hours",60,i))&&(l=g(a,l,"hours","days",24,i))&&(l=g(a,l,"days","weeks",7,i))&&(l=g(a,l,"weeks","months",c(a.refMonth)/7,i))){f=l;var m,n=a.refMonth,o=n.getTime(),p=new Date(o);if(p.setFullYear(n.getFullYear()+1),m=Math.round((p.getTime()-o)/864e5),(l=g(a,f,"months","years",m/c(a.refMonth),i))&&(l=g(a,l,"years","decades",10,i))&&(l=g(a,l,"decades","centuries",10,i))&&(l=g(a,l,"centuries","millennia",10,i)))throw Error("Fractional unit overflow")}}}finally{delete a.refMonth}return a}function i(a,b,c,e,g){var i;c=+c||222,e=e>0?e:0/0,g=g>0?20>g?Math.round(g):20:0;var j=null;"function"==typeof a?(i=a,a=null):a instanceof Date||(null!==a&&isFinite(a)?a=new Date(+a):("object"==typeof j&&(j=a),a=null));var k=null;if("function"==typeof b?(i=b,b=null):b instanceof Date||(null!==b&&isFinite(b)?b=new Date(+b):("object"==typeof b&&(k=b),b=null)),j&&(a=d(j,b)),k&&(b=d(k,a)),!a&&!b)return new f;if(!i)return h(new f,a,b,c,e,g);var l,j=1&c?1e3/30:2&c?1e3:4&c?6e4:8&c?36e5:16&c?864e5:6048e5,k=function(){i(h(new f,a,b,c,e,g),l)};return k(),l=setInterval(k,j)}var j,k,l,m,n,o,p,q=Math.ceil,r=Math.floor;return f.prototype.toString=function(a){var b=p(this),c=b.length;return c?1===c?b[0]:(a=l+b.pop(),b.join(m)+a):a?""+a:n},f.prototype.toHTML=function(a,b){a=a||"span";var c=p(this),d=c.length;if(!d)return(b=b||n)?"<"+a+">"+b+"</"+a+">":b;for(var e=0;d>e;e++)c[e]="<"+a+">"+c[e]+"</"+a+">";return 1===d?c[0]:(d=l+c.pop(),c.join(m)+d)},f.prototype.addTo=function(a){return d(this,a)},p=function(a){var b=[],c=a.millennia;return c&&b.push(e(c,10)),(c=a.centuries)&&b.push(e(c,9)),(c=a.decades)&&b.push(e(c,8)),(c=a.years)&&b.push(e(c,7)),(c=a.months)&&b.push(e(c,6)),(c=a.weeks)&&b.push(e(c,5)),(c=a.days)&&b.push(e(c,4)),(c=a.hours)&&b.push(e(c,3)),(c=a.minutes)&&b.push(e(c,2)),(c=a.seconds)&&b.push(e(c,1)),(c=a.milliseconds)&&b.push(e(c,0)),b},i.MILLISECONDS=1,i.SECONDS=2,i.MINUTES=4,i.HOURS=8,i.DAYS=16,i.WEEKS=32,i.MONTHS=64,i.YEARS=128,i.DECADES=256,i.CENTURIES=512,i.MILLENNIA=1024,i.DEFAULTS=222,i.ALL=2047,i.setLabels=function(a,b,c,d,e,f){a=a||[],a.split&&(a=a.split("|")),b=b||[],b.split&&(b=b.split("|"));for(var g=0;10>=g;g++)j[g]=a[g]||j[g],k[g]=b[g]||k[g];l="string"==typeof c?c:l,m="string"==typeof d?d:m,n="string"==typeof e?e:n,o="function"==typeof f?f:o},(i.resetLabels=function(){j=" millisecond; second; minute; hour; day; week; month; year; decade; century; millennium".split(";"),k=" milliseconds; seconds; minutes; hours; days; weeks; months; years; decades; centuries; millennia".split(";"),l=" and ",m=", ",n="",o=function(a){return a}})(),a&&a.exports?a.exports=i:"function"==typeof window.define&&"undefined"!=typeof window.define.amd&&window.define("countdown",[],function(){return i}),i}(module),getTallies=function(){$.ajax({url:"/api/user/tallies",type:"GET",dataType:"json",success:function(a){$(".tallies ul").html("");for(var b=0;k=a.length,b<k;b++){var c=a[b].color||"#E0E0E0";$(".tallies ul").append('<li data-user="'+a[b].id+'"><span class="user-mark" style="background-color: '+c+'"></span>'+a[b].name+": "+a[b].tally+"</li>")}},error:function(){console.log("error getting tallies")}})},clearWinner=function(a){$.ajax({url:"/api/clear/winner",type:"POST",dataType:"json",data:{category:a},success:function(){getTallies();var b="#"+a;$(b).find("input[type=radio]").removeAttr("checked"),$(b).find(".nominee--info").removeClass("winner loser")},error:function(a){console.log(a),Notifly.create({message:"There was a problem","class":"success",linger:2500,fadeIn:1250,fadeOut:1250})}})};$("form").formjax({success:function(){getTallies()}}),$(".clear-winner").on("click",function(){var a=$(this).data("category");clearWinner(a)}),$(".categories--category h2").on("click",function(){$(this).parent().toggleClass("active")});var prevTallyUser=null;$(".tallies").on("click","li",function(){var a=$(this).data("user");prevTallyUser!=a?($(this).parent().find("li").addClass("inactive"),$(this).removeClass("inactive"),$(".nominee--votes a").addClass("inactive"),$(".nominee--votes").find('[data-user="'+a+'"]').removeClass("inactive"),$(".nominee--favorites a").addClass("inactive"),$(".nominee--favorites").find('[data-user="'+a+'"]').removeClass("inactive"),prevTallyUser=a):($(this).parent().find("li").removeClass("inactive"),$(".nominee--votes a").removeClass("inactive"),$(".nominee--favorites a").removeClass("inactive"),prevTallyUser=null)}),$(".tallies").on("mouseenter","li",function(){var a=$(this).data("user");$(".nominee--votes a").addClass("hoverInactive"),$(".nominee--votes").find('[data-user="'+a+'"]').removeClass("hoverInactive"),$(".nominee--favorites a").addClass("hoverInactive"),$(".nominee--favorites").find('[data-user="'+a+'"]').removeClass("hoverInactive")}),$(".tallies").on("mouseleave","li",function(){$(this).data("user");$(".nominee--votes a").removeClass("hoverInactive"),$(".nominee--favorites a").removeClass("hoverInactive")}),$(".tallies").hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")}),$(".tallies .pin").on("click",function(){console.log("click pin"),$(".tallies").toggleClass("pinned")}),$(".toggle-switches span").on("click",function(){$(this).hasClass("expand")?$(".categories--category").addClass("active"):$(".categories--category").removeClass("active")}),$("form input").on("change",function(){parentCatId="#"+$(this).data("category"),$(parentCatId).submit(),$(parentCatId).find(".nominee--info").removeClass("winner").addClass("loser"),$(this).parents(".nominee--info").removeClass("loser").addClass("winner")});var clock=document.getElementById("time"),targetDate=new Date("Wed Feb 22 2015 16:00:00 GMT-0800 (PST)"),now=new Date;targetDate>now&&(clock.innerHTML=countdown(targetDate).toString(),setInterval(function(){targetDate>now?(clock.innerHTML=countdown(targetDate).toString(),now=new Date):$(".deadline").hide()},1e3)),getTallies();
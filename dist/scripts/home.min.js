var getTallies=function(){$.ajax({url:"/api/user/tallies",type:"GET",dataType:"json",success:function(a){$(".tallies ul").html("");for(var b=0;k=a.length,b<k;b++)$(".tallies ul").append('<li><span class="user-mark" style="background-color: '+a[b].color+'"></span>'+a[b].name+": "+a[b].tally+"</li>")},error:function(){console.log("error getting tallies")}})},clearWinner=function(a){$.ajax({url:"/api/clear/winner",type:"POST",dataType:"json",data:{category:a},success:function(){getTallies();var b="#"+a;$(b).find("input[type=radio]").removeAttr("checked"),$(b).find(".nominee--info").removeClass("winner loser")},error:function(a){console.log(a),Notifly.create({message:"There was a problem","class":"success",linger:2500,fadeIn:1250,fadeOut:1250})}})};$("form").formjax({success:function(){getTallies()}}),$(".clear-winner").on("click",function(){var a=$(this).data("category");clearWinner(a)}),$(".categories--category").on("click",function(){$(this).toggleClass("active")}),$(".toggle-switches span").on("click",function(){$(this).hasClass("expand")?$(".categories--category").addClass("active"):$(".categories--category").removeClass("active")}),$("form input").on("change",function(){parentCatId="#"+$(this).data("category"),$(parentCatId).submit(),$(parentCatId).find(".nominee--info").removeClass("winner").addClass("loser"),$(this).parents(".nominee--info").removeClass("loser").addClass("winner")}),getTallies();